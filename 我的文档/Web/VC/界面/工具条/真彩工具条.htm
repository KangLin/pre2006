<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>真彩工具条</title>
</head>

<body>

<table cellSpacing="0" cellPadding="0" width="100%" border="0">
	<tr bgColor="#a0d39b">
		<td height="30">&nbsp;<a target="_blank" href="http://www.vckbase.com/"><img height="13" src="mk:@MSITStore:d:/books/vcヨ搴\vckbase30.chm::/prjconfig/vckcom.gif" width="109" border="0"></a></td>
		<td vAlign="bottom" align="right" height="30">
		<img height="27" src="mk:@MSITStore:d:/books/vcヨ搴\vckbase30.chm::/prjconfig/earch.gif" width="89"></td>
	</tr>
	<tr bgColor="#eeeeee">
		<td><font class="small" color="#333333">::</font><a target="_blank" href="http://www.vckbase.com/"><font color="black">VC知识库在线杂志</font></a></td>
		<td class="small" align="right">　</td>
	</tr>
</table>
<p>　</p>
<table cellSpacing="0" cellPadding="0" width="100%" border="0">
	<tr>
		<td width="40"></td>
		<td vAlign="top" width="*">[ 本文属于第30期, 适合初级读者 ]
		<p>　</p>
		<table cellSpacing="0" cellPadding="0" width="100%" border="0">
			<tr>
				<td>
				<p align="center"><b>一步步制作真彩工具条<br>
				</b><br>
				<br>
				作者：<a href="mailto:skyformat99@126.com">skyformat99</a></p>
				<p>
				<a href="../../../../../Programe/VC/库/Control/ToolBar/真彩工具条类">下载源代码</a><br>
				<br>
				<br>
				例子程序最终效果图：<br>
				<br>
				<img border="0" src="picture/真彩1.jpg"><br>
				<br>
				　　一直在寻找制作一个 24bit 
				及以上真彩工具条的简单有效方法，在各种VC站点都找到了很多有关这方面的文章和介绍，但是都存在一个不足的地方，介绍的不够详细，对初学者来说有点难度。最近终于有所发现，因此在这里将自己在制作真彩工具条方面的小经验介绍给大家，以期抛砖引玉。<br>
				　　在这里将介绍两个重点的内容，一个是制作真彩工具条的图形工具 Visual 
				toolbar，另一个是在程序中显示工具条的类CtrueColorToolBar。有了这两个利器，几乎能够非常简单快速的制作任何真彩工具条。呵呵。 
				<br>
				<br>
				<img src="mk:@MSITStore:d:/books/vcヨ搴\vckbase30.chm::/images/paragraph.gif"><b> 
				1、Visual Toolbar工具</b> <br>
				<br>
				　　Visual Toolbar 
				是一个工具条制作工具，也是目前唯一的这样的小工具，几乎是一直梦寐以求的超级好用的小工具。呵呵，当我第一次拿到这个东西的时候，只有一个感慨“太实用了！”。<br>
				　　不知道大家以往作工具条的时候是怎样的，反正本人觉得很繁琐，程序员又不是美工，可是为了界面的pp，只好硬着头皮上了，不可能自己画那些图标，那就采用现成的吧，于是只能上网找一些好看得xp图标，然后用 
				photoshop 
				拼啊拼得，一不小心就得从来，费时费力。不知道别人都怎么做的，反正搜索了所有的制作真彩工具条的文章，都没有发现作者提供这样的信息或者方法。每次都很纳闷，当然也有一些作者提供了用ico图标作工具条的方法，不够相比这个有点复杂了。</p>
				<pre>Visual Toolbar 的下载地址：http://visualtoolbar.126.com/</pre>
				<p>界面非常简单，一看就能够理解和动手操作。只需要加入图标就能够生成。如图所示：<br>
				<br>
				<img border="0" src="picture/真彩2.jpg"><br>
				<br>
				　　简单吧，把你找到的一些pp的图标一个个加进去吧，就能自动合并成一个真彩工具条位图，而且还可以再拆分，重新组合，前后位置也可以从新排列。呵呵，不到一分钟，一个pp的bmp位图就完成了。而且还能同时生成normal图，hot图，和disable图。 
				<br>
				<br>
				有了这些位图，真彩工具条就算搞定了一半了。<br>
				<br>
				<img src="mk:@MSITStore:d:/books/vcヨ搴\vckbase30.chm::/images/paragraph.gif">
				<b>2、CtrueColorToolBar类</b> <br>
				<br>
				　　CtrueColorToolBar 类是一个专门加载真彩位图制作 toolbar 的很实用的类。</p>
				<pre>这个类的下载地址是：http://www.codeproject.com/docking/TrueColorToolBar.asp</pre>
				<p>　　确实不错，用这个类配合上面的工具，是一个很不错的组合。下面就用一个例子一步步来实现吧。系统 
				windwos2000＋VC 6.0 + sp5。假设用 Visual toolbar 制作好的工具条如图：<br>
				<br>
				<img border="0" src="picture/真彩3.jpg"></p>
				<ul>
					<li>（1） 先建立一个基于MFC的SDI标准程序，没啥好说的，一路默认吧。 
					</li>
					<li>（2） 这个时候程序会默认生成一个工具条，如图：<br>
					<br>
					<img border="0" src="picture/真彩4.jpg"><br>
					<br>
					先这样放着吧，不理会。 
					</li>
					<li>
					（3）将CtrueColorToolBar类的两个文件拷贝到程序的目录下，并且在FileView中右键单击项目，加入CtrueColorToolBar类的两个文件，如图：<br>
					<br>
					<img border="0" src="picture/真彩5.jpg"><br>
					<br>
					将这两个文件导入进去。然后从新编译一下程序，这时候会发现多了一个CtrueColorToolBar类，这就是了。 
					</li>
					<li>（4） 下面将我们准备好的工具条位图加入到程序中吧，Visual 
					Toolbar能同时生成normal位图和diable位图，假设如下面的所示：<br>
					<br>
					一个是normal图形，一个是disable图形： <br>
					　
					<table id="AutoNumber1" style="border-collapse: collapse" borderColor="#111111" cellSpacing="0" cellPadding="0" width="90%" border="0">
						<tr>
							<td width="48%">
							<p align="center">
							<img border="0" src="picture/真彩6.jpg"></td>
							<td width="52%">
							<p align="center">
							<img border="0" src="picture/真彩7.gif"></td>
						</tr>
						<tr>
							<td width="48%">
							<p align="center">Normal 位图</td>
							<td width="52%">
							<p align="center">Disable 位图</td>
						</tr>
					</table>
					<p>　　先将这两个位图文件拷贝到程序的 res 目录下面，然后在 ResourceView 中单击右键，用 
					Import 
					导入这两个位图，程序会自动生成两个ID号，当然你可以修改ID为IDB_NORMAL和IDB_DISABLE。可以发现，这个例子想要的是7个 
					48×48 拼成的工具条。这个时候将用到系统自动生成的工具条了。 </li>
					<li>（5）找到 toolbar 资源下的 IDR_MAINFRAME 
					我需要的只是7个工具条按钮，这里多了几个，删除多余的吧。由于我们现在需要增加的是一个48×48的大小的按钮，所以还得修改按钮大小。双击其中任何一个按钮，修改大小为： 
					而每个按钮都默认了ID和操作，所以暂时先不管了。 
					</li>
					<li>
					（6）找到程序的CmainFrame框架类的成员变量m_wndToolBar，这东西就是工具条变量了，系统默认的是Ctoolbar类，将Ctoolbar修改成CtrueColorToolBar即可。 
					在程序的引用CtrueColorToolBar类的文件中包含其头文件，本例子是文件MainFrm.h的开头，增加一句： 
					<pre>#include &quot;TrueColorToolBar.h&quot; 
</pre>
					然后找到程序CmainFrame框架类的操作方法OnCreate函数。这里可是产生工具条的地方。增加这样一条语句： 
					<pre>m_wndToolBar.LoadTrueColorToolBar( 48, IDB_NORMAL, IDB_NORMAL, IDB_DISABLED);
</pre>
					3个参数分别代表的意义是：48表示工具条按钮大小是48×48，第二个是normal工具条位图ID，第三个是hot工具条位图ID，最后一个是disable工具条位图ID。 
					增加的位置你参考例子代码。 现在可以编译运行了，怎么用，真彩工具条出来了吧。 
					</li>
					<li>
					（7）最后，你可以和一般程序一样，对系统产生的toolbar资源下的IDR_MAINFRAME工具条的按钮进行设置，编写相应的响应函数即可。例子程序中还有两个位图也添加到资源中了，你可以修改上面m_wndToolBar.LoadTrueColorToolBar函数中后3个参数看看效果，就知道了。 
					</li>
				</ul>
				<img src="mk:@MSITStore:d:/books/vcヨ搴\vckbase30.chm::/images/paragraph.gif">
				<b>3、说明</b> <br>
				　　本文很详细的介绍了制作真彩工具条的方法，并推荐了两个工具。个人感觉这种方法比较快速简单。希望能够给初学者提供一些帮助，也希望能够抛砖引玉得到其它好的方法。（希望站长能够允许转载到其它网站）。<br>
　</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<p>　</p>
<table height="1" cellSpacing="0" cellPadding="0" width="100%" background="mk:@MSITStore:d:/books/vcヨ搴\vckbase30.chm::/prjconfig/dotline.gif" border="0">
	<tr>
		<td>　</td>
	</tr>
</table>
<table cellSpacing="0" cellPadding="0" width="100%" border="0">
	<tr align="middle">
		<td class="eng">Copyright&copy; 1999-2004 vckbase.com All Rights Reserved.</td>
	</tr>
</table>

</body>

</html>
